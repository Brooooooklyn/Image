[package]
edition = "2021"
name = "napi_rs_image"
version = "0.0.0"

[lib]
crate-type = ["cdylib"]

[features]
default = ["oxipng/parallel"]
oxipng_libdeflater = ["oxipng/libdeflater", "oxipng/parallel"]
with_simd = ["mozjpeg-sys/nasm_simd_parallel_build"]

[dependencies]
imagequant = "4.0.0"
image = { version = "0.24" }
infer = "0.7"
jpeg-decoder = "0.2"
libc = "0.2"
libwebp-sys = { version = "0.5", features = ["avx2", "sse41", "neon"] }
lodepng = "3"
napi = { version = "2.3.0-canary.1", default-features = false, features = [
  "napi3",
] }
napi-derive = { version = "2.3.0-canary.1", default-features = false, features = [
  "type-def",
] }
num_cpus = "1"
png = "0.17"
rexif = "0.7"
rgb = "0.8"

[target.'cfg(all(not(target_arch = "arm"), not(target_arch = "x86")))'.dependencies]
libavif = { version = "0.10", default-features = false, features = [
  "codec-aom",
] }

[target.'cfg(any(target_arch = "arm", target_arch = "x86"))'.dependencies]
libavif = { version = "0.10", default-features = false, features = [
  "codec-rav1e",
] }

[dependencies.oxipng]
default-features = false
version = "5"

[dependencies.mozjpeg-sys]
default-features = false
version = "1"

[build-dependencies]
napi-build = "1"
